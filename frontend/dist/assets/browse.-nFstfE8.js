var e=Object.getOwnPropertyNames;import"./modulepreload-polyfill.YP0FEG5d.js";import{p as t,b as n,l as a}from"./apiConfig.BlVLoSjf.js";import"./velura-header.DX1e0Hos.js";var i,o,s=(i={"assets/browse.-nFstfE8.js"(e,i){class o{constructor(){this.playerEndpoint=`${t}/player/play.php`,this.tokenLifetime=72e5,this.oneTimeUse=!0,this.knownWorkingContent=[{id:"634649",type:"tmdb",title:"Spider-Man: No Way Home"},{id:"414906",type:"tmdb",title:"The Batman"},{id:"tt0145487",type:"imdb",title:"Spider-Man (2002)"},{id:"tt0371746",type:"imdb",title:"Iron Man"},{id:"425274",type:"tmdb",title:"Now You See Me"}],this.debugMode=!0,this.sessionId=this.generateSessionId()}generateSessionId(){let e=sessionStorage.getItem("velura_session_id");return e||(e="velura_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),sessionStorage.setItem("velura_session_id",e)),e}generateSecureToken(e,t,n,a,i,o,s=0){const r=Date.now(),l=r+this.tokenLifetime,c={id:e.toString(),type:n||"movie",season:parseInt(a)||1,episode:parseInt(i)||1,title:t||"Movie",idType:o||(e.toString().startsWith("tt")?"imdb":"tmdb"),resumeTime:parseInt(s)||0,timestamp:r,expiry:l,sessionId:this.sessionId,userAgent:navigator.userAgent.substring(0,100),screenRes:`${screen.width}x${screen.height}`,language:navigator.language,hash:this.generateTokenHash(e,r,this.sessionId)};return this.log("Generated secure token:",c),c}generateTokenHash(e,t,n){const a=`${e}_${t}_${n}_velura_secret`;let i=0;for(let o=0;o<a.length;o++)i=(i<<5)-i+a.charCodeAt(o),i&=i;return Math.abs(i).toString(36)}validateToken(e){if(!e||!e.id||!e.timestamp)return{valid:!1,reason:"Invalid token structure"};if(this.oneTimeUse){const t=JSON.parse(sessionStorage.getItem("velura_used_tokens")||"[]"),n=`${e.id}_${e.timestamp}_${e.sessionId}`;if(t.includes(n))return{valid:!1,reason:"Token already used"}}const t=Date.now();if(t>e.expiry)return{valid:!1,reason:"Token expired"};const n=this.generateTokenHash(e.id,e.timestamp,e.sessionId);return e.hash!==n?{valid:!1,reason:"Token tampered"}:{valid:!0,timeLeft:e.expiry-t}}markTokenUsed(e){if(!this.oneTimeUse)return;const t=`${e.id}_${e.timestamp}_${e.sessionId}`,n=JSON.parse(sessionStorage.getItem("velura_used_tokens")||"[]");n.includes(t)||(n.push(t),sessionStorage.setItem("velura_used_tokens",JSON.stringify(n)),this.log("Token marked as used:",t))}openPlayer(e,t="movie",n=1,a=1,i="",o="tmdb",s=0){if(!e)return void this.showError("No content ID found. Please try again.");e=e.toString().trim(),o&&"auto"!==o||(o=e.startsWith("tt")?"imdb":"tmdb"),this.log("Requesting player for:",{contentId:e,title:i,contentType:t,season:n,episode:a,idType:o});const r=this.generateSecureToken(e,i,t,n,a,o,s),l=this.validateToken(r);if(!l.valid)return void this.showError(`Token error: ${l.reason}. Please try again.`);this.markTokenUsed(r);const c=btoa(JSON.stringify(r));sessionStorage.setItem("velura_last_page",window.location.href),sessionStorage.setItem("velura_last_token",JSON.stringify(r));const d=`${this.playerEndpoint}?play=${encodeURIComponent(c)}`;this.log("Navigating to secure player:",{url:d,timeLeft:Math.round(l.timeLeft/1e3)+" seconds",contentType:t,season:n,episode:a}),window.location.href=d}setupWatchButtons(){this.log("Setting up secure watch buttons..."),this.setupHeroButton(),this.setupModalButtons(),this.setupGenericButtons(),this.log("Secure watch buttons setup complete")}setupHeroButton(){const e=document.querySelector(".btn-watch");e?e.hasAttribute("data-secure-bound")||(e.setAttribute("data-secure-bound","true"),e.onclick=null,e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this.log("Hero Watch Now clicked");const t=document.getElementById("heroTitle")?.textContent?.trim()||"Movie",n=this.getHeroContentId();if(n)this.openPlayer(n,"movie",1,1,t,"tmdb");else{const e=this.getFirstTrendingMovieId();e?(this.log("Using fallback ID from trending:",e),this.openPlayer(e,"movie",1,1,t,"tmdb")):this.showError("Please select a movie from the list below first.")}},!0)):this.log("Hero watch button not found","warn")}setupModalButtons(){const e=document.getElementById("detailModal");if(e){if(e.addEventListener("click",t=>{const n=t.target.closest(".watch-btn");if(n){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),this.log("Modal watch button clicked");let a=e.querySelector(".movie-title")?.textContent?.trim()||e.querySelector("h3")?.textContent?.trim()||"Movie",i=n.dataset.tmdbId||n.dataset.id||e.querySelector(".watch-btn")?.dataset?.tmdbId||e.querySelector("[data-tmdb-id]")?.dataset?.tmdbId||e.querySelector("[data-id]")?.dataset?.id||e.dataset.tmdbId||e.dataset.id,o="movie";(e.querySelector('[data-type="tv"]')||"tv"===n.dataset.type)&&(o="tv");let s=1,r=1;if("tv"===o&&(s=parseInt(n.dataset.season)||1,r=parseInt(n.dataset.episode)||1),this.log("Modal data found:",{contentId:i,title:a,contentType:o,season:s,episode:r}),i){const e=i.toString().startsWith("tt")?"imdb":"tmdb";this.openPlayer(i,o,s,r,a,e)}else this.log("No content ID found in modal","error"),this.showError("Could not find content ID for this item.")}},!0),"function"==typeof window.watchContent){const e=window.watchContent;window.watchContent=(t,n)=>{this.log("Intercepted watchContent call:",{youtubeId:t,title:n});const a=document.getElementById("detailModal");let i=null;if(a&&(i=a.querySelector(".watch-btn")?.dataset?.tmdbId||a.querySelector("[data-tmdb-id]")?.dataset?.tmdbId||a.dataset.tmdbId),i){const e=i.toString().startsWith("tt")?"imdb":"tmdb";this.openPlayer(i,"movie",1,1,n,e)}else this.log("No ID in watchContent, using original function"),e(t,n)}}}else this.log("Detail modal not found","warn")}setupGenericButtons(){document.querySelectorAll(".watch-btn:not([data-secure-bound])").forEach(e=>{e.setAttribute("data-secure-bound","true"),e.onclick=null,e.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();const n=e.dataset.tmdbId||e.dataset.id,a=e.dataset.title||"Movie";if(n){const e=n.toString().startsWith("tt")?"imdb":"tmdb";this.openPlayer(n,"movie",1,1,a,e)}else this.log("No ID found on generic button","warn")},!0)})}getHeroContentId(){const e=document.querySelector(".hero-container");if(e){if(e.dataset.tmdbId)return e.dataset.tmdbId;if(e.dataset.id)return e.dataset.id}if(window.currentHeroTmdbId)return window.currentHeroTmdbId;const t=document.querySelector("[data-hero-tmdb-id]");return t?.dataset?.heroTmdbId?t.dataset.heroTmdbId:null}getFirstTrendingMovieId(){const e=document.querySelector(".trending-carousel.movies .card")||document.querySelector(".trending-carousel .card");if(e){if(e.dataset.id)return e.dataset.id;if(e.dataset.tmdbId)return e.dataset.tmdbId}const t=document.querySelector(".card");if(t){if(t.dataset.id)return t.dataset.id;if(t.dataset.tmdbId)return t.dataset.tmdbId}return null}addDebugButton(){if(document.getElementById("player-debug-btn"))return;const e=document.createElement("button");e.id="player-debug-btn",e.innerHTML="ðŸ”’ Test Secure Player",e.style.cssText="\n            position: fixed;\n            bottom: 20px;\n            right: 20px;\n            z-index: 9999;\n            background: linear-gradient(45deg, #00a8ff, #0097e6);\n            color: white;\n            padding: 10px 16px;\n            border: none;\n            border-radius: 25px;\n            cursor: pointer;\n            font-weight: bold;\n            font-size: 14px;\n            box-shadow: 0 4px 15px rgba(0, 168, 255, 0.3);\n        ",e.addEventListener("click",()=>{this.log("Secure test button clicked");const e=this.knownWorkingContent[0];this.openPlayer(e.id,"movie",1,1,e.title,e.type)}),document.body.appendChild(e)}showError(e){const t=document.querySelector(".player-error");t&&t.remove();const n=document.createElement("div");n.className="player-error",n.style.cssText="\n            position: fixed;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            background: rgba(0,0,0,0.95);\n            color: white;\n            padding: 25px 30px;\n            border-radius: 12px;\n            z-index: 10000;\n            text-align: center;\n            border: 2px solid #ff4444;\n            max-width: 400px;\n            width: 90%;\n            box-shadow: 0 10px 30px rgba(255, 68, 68, 0.3);\n        ",n.innerHTML=`\n            <h3 style="color:#ff4444; margin:0 0 15px 0; font-size:18px;">\n                <i class="bi bi-shield-exclamation"></i> Security Error\n            </h3>\n            <p style="margin:0 0 20px 0; line-height:1.5;">${e}</p>\n            <button onclick="this.parentElement.remove()" \n                    style="padding:10px 25px; background:#333; border:none; \n                           color:white; border-radius:6px; cursor:pointer; \n                           font-size:14px; font-weight:500;">\n                OK\n            </button>\n        `,document.body.appendChild(n),setTimeout(()=>{n.parentNode&&n.remove()},5e3)}log(e,t="info",n=null){this.debugMode}checkTokenStatus(){const e=sessionStorage.getItem("velura_last_token");if(e){const t=JSON.parse(e),n=Date.now(),a=t.expiry-n;return a>0?{valid:!0,timeLeft:a,expiresIn:Math.round(a/1e3)+" seconds",content:t.title}:{valid:!1,reason:"Token expired",expiredAgo:Math.round(-a/1e3)+" seconds ago"}}return{valid:!1,reason:"No token found"}}clearTokens(){sessionStorage.removeItem("velura_used_tokens"),sessionStorage.removeItem("velura_last_token"),sessionStorage.removeItem("velura_session_id"),this.log("All tokens cleared","security")}}const s=new o;document.addEventListener("DOMContentLoaded",()=>{window.location.href.includes("play.php")||window.location.href.includes("se_player.php")?window.VeluraPlayer=s:setTimeout(()=>{s.setupWatchButtons(),s.checkTokenStatus().valid},800)}),window.VeluraPlayer=s,window.testSecurePlayer=()=>{s.openPlayer("634649","movie",1,1,"Spider-Man: No Way Home","tmdb")},window.checkTokenStatus=()=>s.checkTokenStatus(),window.clearPlayerTokens=()=>{s.clearTokens(),alert("All player tokens cleared!")},void 0!==i&&i.exports&&(i.exports={Player:o,VeluraPlayer:s}),document.addEventListener("DOMContentLoaded",()=>{const e=document.createElement("style");e.textContent="\n        .player-error {\n            animation: playerErrorFadeIn 0.3s ease;\n        }\n        \n        @keyframes playerErrorFadeIn {\n            from { opacity: 0; transform: translate(-50%, -40%); }\n            to { opacity: 1; transform: translate(-50%, -50%); }\n        }\n        \n        button[data-secure-bound] {\n            cursor: pointer !important;\n        }\n        \n        /* Security badge for debug */\n        #security-badge {\n            position: fixed;\n            bottom: 70px;\n            right: 20px;\n            background: rgba(0,0,0,0.7);\n            color: #00ff88;\n            padding: 5px 10px;\n            border-radius: 10px;\n            font-size: 10px;\n            z-index: 9998;\n            border: 1px solid #00ff88;\n        }\n    ",document.head.appendChild(e)}),window.addEventListener("load",()=>{window.location.href.includes("play.php")||window.location.href.includes("se_player.php")||setTimeout(()=>{window.VeluraPlayer&&window.VeluraPlayer.setupGenericButtons()},1500)}),setTimeout(()=>{const e=s.checkTokenStatus();e.valid||"Token expired"!==e.reason||s.clearTokens()},1e3);const r={trending_movies:18e5,trending_series:18e5,trending_tv:18e5,recommended:9e5,movie_details:36e5,tv_details:36e5,trailer:864e5},l="velura_client_cache_v2",c=new class{constructor(){this.cache=this.loadCache(),this.cleanupOldEntries()}loadCache(){try{const e=sessionStorage.getItem(l);if(e)return JSON.parse(e)}catch(e){}return{}}saveCache(){try{sessionStorage.setItem(l,JSON.stringify(this.cache))}catch(e){this.clearOldestEntries(10)}}get(e){const t=this.cache[e];if(!t)return null;const n=Date.now(),a=r[e.split("_")[0]]||18e5;return n-t.timestamp>a?(delete this.cache[e],this.saveCache(),null):t.data}set(e,t){try{this.cache[e]={data:t,timestamp:Date.now(),size:JSON.stringify(t).length},this.saveCache()}catch(n){this.clearOldestEntries(5),this.cache[e]={data:t,timestamp:Date.now(),size:JSON.stringify(t).length},this.saveCache()}}cleanupOldEntries(){const e=Date.now(),t=Object.keys(this.cache);let n=0;t.forEach(t=>{const a=r[t.split("_")[0]]||18e5;e-this.cache[t].timestamp>2*a&&(delete this.cache[t],n++)}),n>0&&this.saveCache()}clearOldestEntries(e=5){const t=Object.entries(this.cache);if(0!==t.length){t.sort((e,t)=>e[1].timestamp-t[1].timestamp);for(let n=0;n<Math.min(e,t.length);n++)delete this.cache[t[n][0]];this.saveCache()}}getCacheStats(){const e=Object.entries(this.cache),t=e.reduce((e,[t,n])=>e+(n.size||0),0);return{totalEntries:e.length,totalSizeBytes:t,totalSizeKB:Math.round(t/1024*100)/100,totalSizeMB:Math.round(t/1048576*100)/100}}};async function d(){const e="trending_movies",t=c.get(e);if(t)return t;try{const t=await fetch(`${n}/trending/movies`);if(!t.ok)return[];const a=await t.json(),i=Array.isArray(a)?a.slice(0,20):[];return c.set(e,i),i}catch(a){return[]}}async function u(){const e="recommended",t=c.get(e);if(t)return t;try{const t=await fetch(`${n}/recommended`);if(!t.ok)return[];const a=await t.json(),i=Array.isArray(a)?a.slice(0,15):[];return c.set(e,i),i}catch(a){return[]}}async function p(){const e="trending_series",t=c.get(e);if(t)return t;try{const t=await fetch(`${n}/trending/series`);if(!t.ok)return[];const a=await t.json(),i=Array.isArray(a)?a.slice(0,20):[];return c.set(e,i),i}catch(a){return[]}}async function m(){const e="trending_tv",t=c.get(e);if(t)return t;try{const t=await fetch(`${n}/trending/series`);if(!t.ok)return[];const a=await t.json(),i=Array.isArray(a)?a.slice(0,20):[];return c.set(e,i),i}catch(a){return[]}}function y(e){const t={28:"Action",12:"Adventure",16:"Animation",35:"Comedy",80:"Crime",99:"Documentary",18:"Drama",10751:"Family",14:"Fantasy",36:"History",27:"Horror",10402:"Music",9648:"Mystery",10749:"Romance",878:"Science Fiction",10770:"TV Movie",53:"Thriller",10752:"War",37:"Western"};return e.map(e=>t[e]||"").filter(Boolean)}function h(e){if(!e||!e.name||"Unknown Actor"===e.name)return"??";const t=e.name.split(" ");return t.length>=2?(t[0][0]+t[1][0]).toUpperCase():t[0][0]?t[0][0].toUpperCase():"?"}async function v(e,t,a){const i=`${e}_details_${t}`,o=c.get(i);if(o)return o;try{const o=await fetch(`${n}/movie/${e}/${t}`);if(!o.ok)return b(a);const r=await o.json();let l={};const d=`trailer_${e}_${t}`,u=c.get(d);if(u)l=u;else try{const a=await fetch(`${n}/trailer/${e}/${t}`);a.ok&&(l=await a.json(),c.set(d,l))}catch(s){}let p="",m=l.trailer||"";if(m&&(m.includes("youtube.com")||m.includes("youtu.be"))){const e=m.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/);p=e?e[1]:""}let h=[];h=r.credits&&r.credits.cast&&Array.isArray(r.credits.cast)?r.credits.cast.sort((e,t)=>void 0!==e.order&&void 0!==t.order?e.order-t.order:(t.popularity||0)-(e.popularity||0)).slice(0,12).map(e=>({id:e.id,name:e.name||"Unknown Actor",character:e.character||"",profile_path:e.profile_path,popularity:e.popularity||0,order:e.order||999})):[{id:1,name:"Actor 1",character:"Main Role",profile_path:null,popularity:0,order:0},{id:2,name:"Actor 2",character:"Supporting Role",profile_path:null,popularity:0,order:1},{id:3,name:"Actor 3",character:"Supporting Role",profile_path:null,popularity:0,order:2},{id:4,name:"Actor 4",character:"Guest Role",profile_path:null,popularity:0,order:3},{id:5,name:"Actor 5",character:"Guest Role",profile_path:null,popularity:0,order:4}];const v=l.trailer_season?`Season ${l.trailer_season} Trailer`:"tv"===e?"Latest Season Trailer":"Official Trailer",g={...a,...r,trailer:m,youtubeId:p,trailerName:l.trailer_name||v,trailerPublished:l.trailer_published_at,trailerOfficial:l.trailer_official||!1,trailerSeason:l.trailer_season,isLatestSeason:l.is_latest_season||!1,cast:h,genres:Array.isArray(r.genres)?r.genres.map(e=>e.name):a.genre_ids?y(a.genre_ids):["Action","Drama"],runtime:r.runtime||r.episode_run_time?.[0]||Math.floor(180*Math.random())+60,formattedDate:r.release_date||r.first_air_date||a.release_date||"2024-01-01",quality:a.vote_average>7.5?"4K UHD":a.vote_average>6?"HD":"SD",year:(r.release_date||r.first_air_date||a.release_date||"2024-01-01").split("-")[0],overview:r.overview||a.overview||"No description available.",popularity:a.popularity||50,characterCount:h.length,media_type:"movie"===e?"Movie":"TV Series",seasonCount:r.number_of_seasons||1,latestSeasonInfo:`Season ${r.number_of_seasons||1} (Latest)`};return c.set(i,g),g}catch(s){return b(a)}}function b(e){const t=e.release_date||e.first_air_date||"2024-01-01",n=e.vote_average>7.5?"4K UHD":e.vote_average>6?"HD":"SD",a=Math.floor(180*Math.random())+60,i=e.genre_ids?y(e.genre_ids):["Action","Drama"],o=[{id:1,name:"Actor 1",character:"Main Role",profile_path:null,popularity:0,order:0},{id:2,name:"Actor 2",character:"Supporting Role",profile_path:null,popularity:0,order:1},{id:3,name:"Actor 3",character:"Supporting Role",profile_path:null,popularity:0,order:2},{id:4,name:"Actor 4",character:"Guest Role",profile_path:null,popularity:0,order:3},{id:5,name:"Actor 5",character:"Guest Role",profile_path:null,popularity:0,order:4}];return{...e,trailer:"",youtubeId:"",cast:o,genres:i,runtime:a,formattedDate:new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),quality:n,year:t.split("-")[0],overview:e.overview||"No description available.",popularity:e.popularity||50,characterCount:o.length,media_type:e.media_type||"Movie"}}function g(e,t){const n=document.createElement("div");n.className="card";const a=document.createElement("img");a.src=`https://image.tmdb.org/t/p/w300${e.poster_path}`,a.alt=e.title||e.name,a.loading="lazy";const i=document.createElement("p");i.textContent=e.title||e.name;const o=document.createElement("div");return o.className="card-rating",o.innerHTML=`<i class="bi bi-star-fill"></i> ${e.vote_average?.toFixed(1)||"N/A"}`,n.appendChild(a),n.appendChild(i),n.appendChild(o),n.dataset.id=e.id,n.dataset.title=e.title||e.name,e.first_air_date&&(n.dataset.isSeries="true"),"tv"===e.media_type&&(n.dataset.isSeries="true"),function(e,t,n){e.addEventListener("click",async()=>{q();const e=function(e,t){if(e.media_type)return e.media_type;if(e.first_air_date)return"tv";if(e.release_date)return"movie";switch(t){case"movies":case"recommended":default:return"movie";case"series":case"tv":return"tv"}}(t,n);if("tv"===e||"tv"===t.media_type||t.first_air_date||"series"===n||"tv"===n)try{N(await v(e,t.id,t))}catch(a){await D(e,t.id,t)}else await D(e,t.id,t)})}(n,e,t),n}function f(e,t){const n=document.querySelector(`.trending-carousel.${e}`);n&&(n.innerHTML="",0!==t.length?t.forEach(t=>{const a=g(t,e);n.appendChild(a)}):n.innerHTML=`\n            <div class="no-content">\n                <i class="bi bi-film"></i>\n                <p>No ${e} available</p>\n            </div>\n        `)}let w=null,S=null,$=1,I=1;async function _(e,t){try{const a=await fetch(`${n}/tv/${e}/season/${t}`);if(a.ok){const e=await a.json(),t=e.episodes||[],n=new Date,i=t.filter(e=>!!e.air_date&&new Date(e.air_date)<=n);return{episodes:i.map(t=>{const n=t.still_path?`https://image.tmdb.org/t/p/w300${t.still_path}`:e.poster_path?`https://image.tmdb.org/t/p/w300${e.poster_path}`:`https://image.tmdb.org/t/p/w300${w.poster_path}`,a=t.runtime||w.runtime||45,i=a>60?`${Math.floor(a/60)}h ${a%60}m`:`${a}m`,o=t.air_date?new Date(t.air_date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"TBA";return{...t,episodeImage:n,runtimeText:i,formattedDate:o,isReleased:!0}}),totalEpisodes:t.length,releasedCount:i.length}}}catch(a){}return{episodes:[],totalEpisodes:8,releasedCount:0}}function E(e){const t=document.getElementById("episodesListContainer"),n=document.getElementById("episodeCountFullwidth");if(t&&n){if(0===e.episodes.length)return t.innerHTML='\n            <div class="no-episodes">\n                <i class="bi bi-tv"></i>\n                <h4>No Episodes Available</h4>\n                <p>Episodes for this season will be available soon.</p>\n            </div>\n        ',void(n.innerHTML=`\n            <span class="loaded-count">\n                0 of ${e.totalEpisodes} Episodes\n                <span class="release-status-badge">No Episodes</span>\n            </span>\n        `);n.innerHTML=`\n        <span class="loaded-count">\n            ${e.releasedCount} of ${e.totalEpisodes} Episodes\n            <span class="release-status-badge">\n                ${e.releasedCount===e.totalEpisodes?"All Released":"Partial Release"}\n            </span>\n        </span>\n    `,t.innerHTML=e.episodes.map(e=>{const t=!1===e.isReleased,n=e.episode_number;return`\n        <div class="episode-card ${t?"upcoming":""} ${n===I?"selected":""}" \n             data-episode="${n}" \n             onclick="selectEpisode(${n})">\n            <div class="episode-image-container">\n                <img src="${e.episodeImage}" \n                     alt="${e.name||`Episode ${n}`}"\n                     class="episode-image"\n                     loading="lazy">\n                <div class="episode-overlay">\n                    <div class="play-episode-btn">\n                        <i class="bi bi-play-fill"></i>\n                    </div>\n                    <div class="episode-number-badge">\n                        <span>${n}</span>\n                    </div>\n                </div>\n                ${n===I?'\n                <div class="selected-indicator">\n                    <i class="bi bi-check-circle-fill"></i>\n                </div>\n                ':""}\n            </div>\n            \n            <div class="episode-content">\n                <div class="episode-header">\n                    <h4 class="episode-title">\n                        ${e.name||`Episode ${n}`}\n                        ${t?'<span class="upcoming-badge">Coming Soon</span>':""}\n                    </h4>\n                    <div class="episode-meta-right">\n                        <span class="episode-runtime-badge">\n                            <i class="bi bi-clock"></i>\n                            ${e.runtimeText}\n                        </span>\n                    </div>\n                </div>\n                \n                <div class="episode-details">\n                    <p class="episode-description">${e.overview||"No description available."}</p>\n                    \n                    <div class="episode-footer">\n                        <div class="episode-stats">\n                            <span class="episode-rating">\n                                <i class="bi bi-star-fill"></i>\n                                ${e.vote_average?.toFixed(1)||"N/A"}\n                            </span>\n                            <span class="episode-date">\n                                <i class="bi bi-calendar3"></i>\n                                ${e.formattedDate}\n                            </span>\n                        </div>\n                        <button class="watch-episode-btn" \n                                onclick="window.selectEpisode(${n}); window.watchSelectedSeriesEpisode(); event.stopPropagation();"\n                                ${t?"disabled":""}>\n                            <i class="bi bi-play-fill"></i>\n                            ${t?"Coming Soon":"Watch Now"}\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `}).join("")}}function T(){const e="youtube-complete-hide";let t=document.getElementById(e);t||(t=document.createElement("style"),t.id=e,t.textContent="\n            /* Hide EVERY YouTube element */\n            .ytp-chrome-top,\n            .ytp-chrome-bottom,\n            .ytp-progress-bar,\n            .ytp-progress-bar-container,\n            .ytp-time-display,\n            .ytp-title,\n            .ytp-watermark,\n            .ytp-button,\n            .ytp-settings-button,\n            .ytp-fullscreen-button,\n            .ytp-large-play-button,\n            .ytp-play-button,\n            .ytp-pause-button,\n            .ytp-logo,\n            .ytp-contextmenu,\n            .ytp-tooltip,\n            .ytp-ce-element,\n            .ytp-gradient-top,\n            .ytp-gradient-bottom,\n            .ytp-menuitem,\n            .ytp-cards-teaser,\n            .ytp-pause-overlay {\n                display: none !important;\n                opacity: 0 !important;\n                visibility: hidden !important;\n                width: 0 !important;\n                height: 0 !important;\n                pointer-events: none !important;\n            }\n            \n            /* Specifically target progress bar */\n            .ytp-progress-bar {\n                height: 0px !important;\n            }\n            \n            /* Hide any hover states */\n            .ytp-progress-bar:hover,\n            .ytp-chrome-controls:hover {\n                display: none !important;\n            }\n            \n            /* Make sure iframe doesn't show any controls */\n            #youtubeIframe iframe {\n                width: 100% !important;\n                height: 100% !important;\n            }\n        ",document.head.appendChild(t));const n=document.querySelector("#youtubeIframe iframe");n&&(n.style.cssText="\n            width: 100% !important;\n            height: 100% !important;\n            border: none !important;\n            position: absolute !important;\n            top: 0 !important;\n            left: 0 !important;\n        ",n.onmouseover=function(){this.style.pointerEvents="none"});const a=setInterval(()=>{document.querySelectorAll('[class*="ytp-"]').forEach(e=>{"none"!==e.style.display&&(e.style.display="none",e.style.opacity="0",e.style.visibility="hidden",e.style.pointerEvents="none")})},500);window.youtubeHideInterval=a}function k(e){if(window.youtubePlayer){try{window.youtubePlayer.destroy()}catch(t){}window.youtubePlayer=null}window.youtubePlayer=new YT.Player("youtubeIframe",{videoId:e,host:"https://www.youtube-nocookie.com",playerVars:{autoplay:1,mute:1,controls:0,rel:0,modestbranding:1,playsinline:1,origin:window.location.origin,enablejsapi:1,iv_load_policy:3,vq:"hd720",autohide:1,showinfo:0,fs:0,disablekb:1,iv_load_policy:3,widget_referrer:window.location.origin,controls:0,nocookie:1,wmode:"transparent",origin:window.location.origin},events:{onReady:function(e){A(!0),window.isMuted=!0,setTimeout(()=>{T();const n=document.getElementById("youtubeIframe");if(n&&n.querySelector("iframe")){const a=n.querySelector("iframe");if(a){a.style.cssText="\n                                width: 100% !important;\n                                height: 100% !important;\n                                position: absolute !important;\n                                top: 0 !important;\n                                left: 0 !important;\n                                border: none !important;\n                            ";try{e.target.setOption("controls",0),e.target.setOption("showinfo",0),e.target.setOption("modestbranding",1)}catch(t){}}}},100);try{e.target.getAvailableQualityLevels().includes("hd720")&&e.target.setPlaybackQuality("hd720")}catch(n){}},onStateChange:function(e){e.data===YT.PlayerState.ENDED&&x(),e.data===YT.PlayerState.PLAYING&&setTimeout(()=>{T()},300)},onError:function(e){}}})}function x(){const e=document.querySelector(".youtube-protection-layer"),t=w||S;if(e&&t){const n=e.querySelector(".iframe-container");n&&(n.style.display="none");const a=document.createElement("div");a.className="video-ended-poster",a.innerHTML=`\n            <img src="https://image.tmdb.org/t/p/w780${t.poster_path}" \n                 alt="${t.title||t.name}"\n                 class="ended-poster-img">\n            <div class="ended-overlay">\n                <button class="replay-center-btn" onclick="replayTrailerFromEnd()">\n                    <i class="bi bi-play-circle"></i>\n                    <span>Replay Trailer</span>\n                </button>\n            </div>\n        `;const i=e.querySelector(".video-ended-poster");i&&i.remove();const o=e.querySelector(".trailer-controls-bottom");o&&(o.style.display="none"),e.appendChild(a)}}function L(){const e=document.querySelector(".youtube-protection-layer"),t=document.getElementById("detailModal"),n=t?.dataset?.youtubeId;if(e&&n){const t=e.querySelector(".video-ended-poster");t&&t.remove();const n=e.querySelector(".iframe-container");n&&(n.style.display="block");const a=e.querySelector(".trailer-controls-bottom");a&&(a.style.display="flex"),window.youtubePlayer&&(window.youtubePlayer.seekTo(0,!0),window.youtubePlayer.playVideo(),window.isMuted?window.youtubePlayer.mute():window.youtubePlayer.unMute())}}function C(){const e=document.getElementById("detailModal"),t=e?.dataset?.youtubeId,n=document.querySelector(".youtube-protection-layer");if(n&&t){n.querySelector(".trailer-overlay"),n.querySelector(".trailer-info");const e=n.querySelector(".iframe-container");e&&(e.innerHTML='<div id="youtubeIframe"></div>'),setTimeout(()=>{"undefined"!=typeof YT&&YT.Player?k(t):M(t)},100)}}function M(e){if("undefined"!=typeof YT&&YT.Player)k(e);else{const t=document.createElement("script");t.src="https://www.youtube.com/iframe_api";const n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);const a=setInterval(()=>{"undefined"!=typeof YT&&YT.Player&&(clearInterval(a),k(e))},100)}}function B(){if(window.youtubePlayer)try{window.isMuted?(window.youtubePlayer.unMute(),window.youtubePlayer.setVolume(70),A(!1),window.isMuted=!1):(window.youtubePlayer.mute(),A(!0),window.isMuted=!0)}catch(e){}}function A(e){const t=document.querySelector(".mute-toggle-btn");t&&(t.innerHTML=e?'<i class="bi bi-volume-mute-fill"></i><span>Unmute</span>':'<i class="bi bi-volume-up-fill"></i><span>Mute</span>')}function P(e){const t=e.closest(".cast-details").querySelector(".cast-grid"),n=t.querySelectorAll(".cast-card-hidden"),a=e.querySelector("i"),i=e.querySelector("span");t.classList.contains("cast-grid-expanded")?(t.classList.remove("cast-grid-expanded"),t.classList.add("cast-grid-limited"),n.forEach(e=>{e.style.display="none",e.classList.add("cast-card-hidden")}),a.className="bi bi-chevron-down",i.textContent="Show More"):(t.classList.remove("cast-grid-limited"),t.classList.add("cast-grid-expanded"),n.forEach(e=>{e.style.display="flex",e.classList.remove("cast-card-hidden")}),a.className="bi bi-chevron-up",i.textContent="Show Less")}async function D(e,t,n){try{N(await v(e,t,n))}catch(a){!function(e){const t=document.getElementById("detailModal"),n=e.release_date?.split("-")[0]||e.first_air_date?.split("-")[0]||"2024",a=e.vote_average>7.5?"4K UHD":e.vote_average>6?"HD":"SD",i=e.genre_ids?y(e.genre_ids):["Action","Drama"],o=[{id:1,name:"Actor 1",character:"Main Role",profile_path:null,popularity:0,order:0},{id:2,name:"Actor 2",character:"Supporting Role",profile_path:null,popularity:0,order:1},{id:3,name:"Actor 3",character:"Supporting Role",profile_path:null,popularity:0,order:2},{id:4,name:"Actor 4",character:"Guest Role",profile_path:null,popularity:0,order:3},{id:5,name:"Actor 5",character:"Guest Role",profile_path:null,popularity:0,order:4}];t.innerHTML=`\n        <div class="modal-content">\n            <button class="close-btn" onclick="closeModal()">&times;</button>\n            \n            <div class="modal-layout">\n                <div class="modal-left">\n                    <div class="trailer-container">\n                        <div class="no-trailer-placeholder">\n                            <div class="poster-preview">\n                                <img src="https://image.tmdb.org/t/p/w500${e.poster_path}" \n                                     alt="${e.title||e.name}">\n                                <div class="play-overlay">\n                                    <i class="bi bi-play-fill"></i>\n                                </div>\n                            </div>\n                            <p class="no-trailer-text">Trailer not available</p>\n                        </div>\n                    </div>\n                    \n                    <div class="movie-info-card">\n                        <div class="info-header">\n                            <h3 class="movie-title">${e.title||e.name}</h3>\n                            <div class="quick-stats">\n                                <span class="rating-stat">\n                                    <i class="bi bi-star-fill"></i>\n                                    <strong>${e.vote_average?.toFixed(1)||"N/A"}</strong>/10\n                                </span>\n                                <span class="quality-stat">\n                                    <i class="bi bi-hdd-stack"></i>\n                                    ${a}\n                                </span>\n                                <span class="year-stat">\n                                    <i class="bi bi-calendar3"></i>\n                                    ${n}\n                                </span>\n                            </div>\n                        </div>\n                        \n                        <div class="category-chips">\n                            ${i.map(e=>`<span class="category-chip">${e}</span>`).join("")}\n                        </div>\n                        \n                        <div class="description-box">\n                            <h4>Description</h4>\n                            <p>${e.overview||"No description available."}</p>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class="modal-right">\n                    \x3c!-- CAST SECTION --\x3e\n                    <div class="cast-details">\n                        <div class="cast-header">\n                            <h3 class="section-title">\n                                <i class="bi bi-people-fill"></i>\n                                Cast <span class="cast-count">(${o.length})</span>\n                            </h3>\n                        </div>\n                        <div class="cast-grid">\n                            ${o.map(e=>`\n                                <div class="cast-card">\n                                    <div class="cast-avatar">\n                                        ${h(e)}\n                                    </div>\n                                    <div class="cast-info">\n                                        <span class="cast-name" title="${e.name}">${e.name}</span>\n                                        ${e.character?`\n                                        <span class="cast-character" title="${e.character}">as ${e.character}</span>\n                                        `:""}\n                                    </div>\n                                </div>\n                            `).join("")}\n                        </div>\n                    </div>\n                    \n                    <div class="action-buttons-grid">\n                        <button class="primary-action-btn watch-btn" onclick="watchContent('', '${e.title||e.name}')">\n                            <i class="bi bi-play-fill"></i>\n                            <span>Watch Now</span>\n                        </button>\n                        \n                        <button class="secondary-action-btn" onclick="addToWatchlist('${e.id}', '${e.media_type||"movie"}')">\n                            <i class="bi bi-plus-lg"></i>\n                            <span>Add to List</span>\n                        </button>\n                        \n                        <button class="secondary-action-btn" onclick="shareContent('${e.title||e.name}', '${e.id}')">\n                            <i class="bi bi-share"></i>\n                            <span>Share</span>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `,t.classList.add("active"),document.body.classList.add("modal-open")}(n)}}function q(){const e=document.getElementById("detailModal");e.innerHTML='\n        <div class="modal-content loading">\n            <div class="loading-modal">\n                <div class="spinner"></div>\n                <p>Loading details...</p>\n            </div>\n        </div>\n    ',e.classList.add("active"),document.body.classList.add("modal-open")}function N(e){const t=document.getElementById("detailModal"),n=!!e.youtubeId,a="TV Series"===e.media_type||"tv"===e.media_type||e.first_air_date||e.number_of_seasons>0||e.seasonCount>1,i=e.cast.length>6;a?(w=e,S=null):(S=e,w=null),a&&($=1,I=1),e.youtubeId&&(t.dataset.youtubeId=e.youtubeId),t.innerHTML=`\n        <div class="modal-content">\n            <button class="close-btn" onclick="closeModal()">&times;</button>\n            \n            <div class="modal-layout">\n                \n                \x3c!-- LEFT COLUMN: TRAILER --\x3e\n                <div class="modal-left">\n                    <div class="trailer-container">\n                        ${n?`\n                        \x3c!-- YOUTUBE PROTECTION LAYER - ULTRA SECURE --\x3e\n                        <div class="youtube-protection-layer">\n                            <div class="iframe-container">\n                                <div id="youtubeIframe"></div>\n                            </div>\n                            \n                            \x3c!-- Blocking overlay - blocks ALL YouTube interactions --\x3e\n                            <div class="youtube-blocker" \n                                 onclick="return false"\n                                 oncontextmenu="return false" \n                                 ondragstart="return false" \n                                 onselectstart="return false"\n                                 onmousedown="return false"\n                                 onmouseup="return false"\n                                 style="cursor: default;"></div>\n                            \n                            \x3c!-- OUR CONTROLS ONLY --\x3e\n                            <div class="trailer-controls-bottom">\n                                <div class="controls-left">\n                                    <button class="mute-toggle-btn" onclick="toggleMute(); event.stopPropagation();">\n                                        <i class="bi bi-volume-mute-fill"></i>\n                                        <span>Unmute</span>\n                                    </button>\n                                    <button class="replay-corner-btn" onclick="replayTrailerSimple(); event.stopPropagation();">\n                                        <i class="bi bi-arrow-clockwise"></i>\n                                        <span>Replay</span>\n                                    </button>\n                                </div>\n                                \n                                <div class="controls-right">\n                                    ${e.trailerOfficial?'\n                                    <span class="official-badge">\n                                        <i class="bi bi-patch-check-fill"></i>\n                                        Official\n                                    </span>\n                                    ':""}\n                                    <span class="quality-badge">\n                                        <i class="bi bi-hd"></i>\n                                        720p HD\n                                    </span>\n                                </div>\n                            </div>\n                        </div>\n                        `:`\n                        <div class="no-trailer-placeholder">\n                            <div class="poster-preview">\n                                <img src="https://image.tmdb.org/t/p/w500${e.poster_path}" \n                                     alt="${e.title||e.name}">\n                                <div class="play-overlay">\n                                    <i class="bi bi-play-fill"></i>\n                                </div>\n                            </div>\n                            <p class="no-trailer-text">Trailer not available</p>\n                            ${a&&(e.seasonCount||e.number_of_seasons)?`\n                            <div class="season-info-badge">\n                                <i class="bi bi-collection-play"></i>\n                                ${e.seasonCount||e.number_of_seasons||1} Season${(e.seasonCount||e.number_of_seasons||1)>1?"s":""}\n                            </div>\n                            `:""}\n                        </div>\n                        `}\n                    </div>\n                    \n                    \x3c!-- MOVIE INFO CARD --\x3e\n                    <div class="movie-info-card">\n                        <div class="info-header">\n                            <h3 class="movie-title">${e.title||e.name}</h3>\n                            <div class="quick-stats">\n                                <span class="rating-stat">\n                                    <i class="bi bi-star-fill"></i>\n                                    <strong>${e.vote_average?.toFixed(1)||"N/A"}</strong>/10\n                                </span>\n                                <span class="quality-stat">\n                                    <i class="bi bi-hdd-stack"></i>\n                                    ${e.quality}\n                                </span>\n                                ${a?`\n                                <span class="season-stat">\n                                    <i class="bi bi-collection-play"></i>\n                                    ${e.seasonCount||e.number_of_seasons||1} Season${(e.seasonCount||e.number_of_seasons||1)>1?"s":""}\n                                </span>\n                                `:`\n                                <span class="year-stat">\n                                    <i class="bi bi-calendar3"></i>\n                                    ${e.year}\n                                </span>\n                                `}\n                            </div>\n                        </div>\n                        \n                        <div class="category-chips">\n                            ${e.genres.map(e=>`<span class="category-chip">${e}</span>`).join("")}\n                            ${a?'<span class="category-chip">TV Series</span>':'<span class="category-chip">Movie</span>'}\n                        </div>\n                        \n                        <div class="description-box">\n                            <h4>Synopsis</h4>\n                            <p>${e.overview}</p>\n                            ${a&&(e.latestSeasonInfo||e.seasonCount)?`\n                            <div class="latest-season-info">\n                                <i class="bi bi-info-circle"></i>\n                                Latest: Season ${e.seasonCount||e.number_of_seasons||1}\n                            </div>\n                            `:""}\n                        </div>\n                    </div>\n                </div>\n                \n                \x3c!-- RIGHT COLUMN: DETAILS --\x3e\n                <div class="modal-right">\n                    \x3c!-- CAST SECTION WITH REAL DATA --\x3e\n                    <div class="cast-details">\n                        <div class="cast-header">\n                            <h3 class="section-title">\n                                <i class="bi bi-people-fill"></i>\n                                Cast <span class="cast-count">(${e.characterCount})</span>\n                            </h3>\n                            ${i?'\n                            <button class="toggle-cast-btn" onclick="toggleCastView(this)">\n                                <i class="bi bi-chevron-down"></i>\n                                <span>Show More</span>\n                            </button>\n                            ':""}\n                        </div>\n                        <div class="cast-grid ${i?"cast-grid-limited":""}">\n                            ${e.cast.slice(0,6).map(e=>`\n                                <div class="cast-card">\n                                    ${e.profile_path?`\n                                    <img class="cast-profile-img" \n                                         src="https://image.tmdb.org/t/p/w185${e.profile_path}" \n                                         alt="${e.name}"\n                                         loading="lazy">\n                                    `:`\n                                    <div class="cast-avatar">\n                                        ${h(e)}\n                                    </div>\n                                    `}\n                                    <div class="cast-info">\n                                        <span class="cast-name" title="${e.name}">${e.name}</span>\n                                        ${e.character?`\n                                        <span class="cast-character" title="${e.character}">as ${e.character}</span>\n                                        `:""}\n                                    </div>\n                                </div>\n                            `).join("")}\n                            ${i?e.cast.slice(6).map(e=>`\n                                <div class="cast-card cast-card-hidden">\n                                    ${e.profile_path?`\n                                    <img class="cast-profile-img" \n                                         src="https://image.tmdb.org/t/p/w185${e.profile_path}" \n                                         alt="${e.name}"\n                                         loading="lazy">\n                                    `:`\n                                    <div class="cast-avatar">\n                                        ${h(e)}\n                                    </div>\n                                    `}\n                                    <div class="cast-info">\n                                        <span class="cast-name" title="${e.name}">${e.name}</span>\n                                        ${e.character?`\n                                        <span class="cast-character" title="${e.character}">as ${e.character}</span>\n                                        `:""}\n                                    </div>\n                                </div>\n                            `).join(""):""}\n                        </div>\n                    </div>\n                    \n                    \x3c!-- ADDITIONAL DETAILS --\x3e\n                    <div class="additional-details-grid">\n                        <div class="detail-box">\n                            <div class="detail-icon">\n                                <i class="bi bi-clock-history"></i>\n                            </div>\n                            <div class="detail-content">\n                                <span class="detail-label">${a?"Avg Duration":"Duration"}</span>\n                                <span class="detail-value">${Math.floor(e.runtime/60)}h ${e.runtime%60}m</span>\n                            </div>\n                        </div>\n                        \n                        <div class="detail-box">\n                            <div class="detail-icon">\n                                <i class="bi bi-calendar-event"></i>\n                            </div>\n                            <div class="detail-content">\n                                <span class="detail-label">${a?"First Air Date":"Release Date"}</span>\n                                <span class="detail-value">${e.formattedDate}</span>\n                            </div>\n                        </div>\n                        \n                        <div class="detail-box">\n                            <div class="detail-icon">\n                                <i class="bi bi-film"></i>\n                            </div>\n                            <div class="detail-content">\n                                <span class="detail-label">Content Type</span>\n                                <span class="detail-value">${e.media_type}</span>\n                            </div>\n                        </div>\n                        \n                        <div class="detail-box">\n                            <div class="detail-icon">\n                                <i class="bi ${n?"bi-play-circle-fill text-success":"bi-play-circle"}"></i>\n                            </div>\n                            <div class="detail-content">\n                                <span class="detail-label">Trailer</span>\n                                <span class="detail-value">${n?"Available":"Not Available"}</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- ACTION BUTTONS --\x3e\n                    <div class="action-buttons-grid">\n                        \x3c!-- SERIES: Use the episode-specific watch function --\x3e\n                        ${a?`\n                        <button class="primary-action-btn watch-btn" \n                                id="watchSeriesBtn"\n                                onclick="watchSelectedSeriesEpisode()"\n                                data-tmdb-id="${e.id}"\n                                data-type="tv"\n                                data-season="${$||1}"\n                                data-episode="${I||1}">\n                            <i class="bi bi-play-fill"></i>\n                            <span>Watch ${e.episode_count?"Episode 1":"Now"}</span>\n                        </button>\n                        `:`\n                        \x3c!-- MOVIE: Regular watch button --\x3e\n                        <button class="primary-action-btn watch-btn" \n                                onclick="${n?`watchContent('${e.youtubeId||""}', '${e.title||e.name}')`:`window.VeluraPlayer.openPlayer('${e.id}', 'movie', 1, 1, '${e.title||e.name}'.replace(/'/g, "\\'"), 'tmdb')`}"\n                                data-tmdb-id="${e.id}"\n                                data-type="movie">\n                            <i class="bi bi-play-fill"></i>\n                            <span>Watch Now</span>\n                        </button>\n                        `}\n                        \n                        <button class="secondary-action-btn" onclick="addToWatchlist('${e.id}', '${a?"tv":"movie"}')">\n                            <i class="bi bi-plus-lg"></i>\n                            <span>Add to Watchlist</span>\n                        </button>\n                        \n                        <button class="secondary-action-btn" onclick="shareContent('${e.title||e.name}', '${e.id}')">\n                            <i class="bi bi-share"></i>\n                            <span>Share</span>\n                        </button>\n                        \n                        ${n?'\n                        <button class="secondary-action-btn" onclick="replayTrailerSimple()">\n                            <i class="bi bi-play-circle"></i>\n                            <span>Replay Trailer</span>\n                        </button>\n                        ':""}\n                    </div>\n                    \n                    \x3c!-- SIMILAR CONTENT --\x3e\n                    <div class="similar-content">\n                        <h3 class="section-title">\n                            <i class="bi bi-collection-play"></i>\n                            More Like This\n                        </h3>\n                        <div class="similar-tags">\n                            ${e.genres.slice(0,3).map(e=>`<span class="similar-tag">${e}</span>`).join("")}\n                            <span class="similar-tag">${e.year} Releases</span>\n                            ${a?'<span class="similar-tag">TV Series</span>':'<span class="similar-tag">Movies</span>'}\n                            ${n?'<span class="similar-tag">Has Trailer</span>':""}\n                        </div>\n                    </div>\n                </div>\n            </div>\n            \n            \x3c!-- FULL-WIDTH EPISODES SECTION (BELOW THE TWO COLUMNS) --\x3e\n            ${a?`\n            <div class="fullwidth-episodes-section">\n                <div class="episodes-header">\n                    <h2 class="episodes-title">\n                        <i class="bi bi-play-circle"></i>\n                        Episodes\n                        ${e.latestSeasonInfo?`<span class="latest-season-badge">${e.latestSeasonInfo}</span>`:""}\n                    </h2>\n                    \n                    \x3c!-- Season Selector --\x3e\n                    <div class="season-selector-container">\n                        <div class="season-selector-header">\n                            <label for="seasonSelectFullwidth" class="season-select-label">\n                                <i class="bi bi-collection-play"></i>\n                                Season\n                            </label>\n                            <div class="season-dropdown-wrapper">\n                                <select class="season-select-fullwidth" id="seasonSelectFullwidth" onchange="changeSeason(this.value)">\n                                    ${Array.from({length:e.seasonCount||e.number_of_seasons||1},(e,t)=>t+1).map(t=>`\n                                        <option value="${t}" ${t===(e.seasonCount||1)?"selected":""}>\n                                            Season ${t} ${t===(e.seasonCount||1)?"(Latest)":""}\n                                        </option>\n                                    `).join("")}\n                                </select>\n                                <div class="dropdown-arrow-fullwidth">\n                                    <i class="bi bi-chevron-down"></i>\n                                </div>\n                            </div>\n                        </div>\n                        \n                        <div class="episode-count-display" id="episodeCountFullwidth">\n                            <span class="loading-count">Loading episodes...</span>\n                        </div>\n                    </div>\n                </div>\n                \n                \x3c!-- Episode List --\x3e\n                <div class="episodes-list-container" id="episodesListContainer">\n                    <div class="loading-episodes">\n                        <div class="spinner-large"></div>\n                        <p>Loading episodes...</p>\n                    </div>\n                </div>\n            </div>\n            `:""}\n        </div>\n    `,t.classList.add("active"),document.body.classList.add("modal-open"),n&&setTimeout(()=>{"undefined"!=typeof YT&&YT.Player?k(e.youtubeId):M(e.youtubeId)},100),a&&setTimeout(async()=>{const t=document.getElementById("episodesListContainer");t&&(t.innerHTML='\n                    <div class="loading-episodes">\n                        <div class="spinner-large"></div>\n                        <p>Loading episodes...</p>\n                    </div>\n                ');const n=e.seasonCount||e.number_of_seasons||1;$=n,E(await _(e.id,n))},100)}function R(){if(document.getElementById("detailModal").classList.remove("active"),document.body.classList.remove("modal-open"),window.youtubePlayer){try{window.youtubePlayer.stopVideo(),window.youtubePlayer.destroy()}catch(e){}window.youtubePlayer=null}window.isMuted=!0}function H(){document.querySelectorAll(".scroll-btn").forEach(e=>{e.addEventListener("click",function(e,t){let n;return function(...a){n||(e.apply(this,a),n=!0,setTimeout(()=>n=!1,t))}}(e=>{!function(e,t){const n=document.querySelector(`.trending-carousel.${e}`);if(!n)return;const a=960;let i=n.scrollLeft+("left"===t?-960:a);const o=n.scrollWidth-n.clientWidth;i>o-10?(n.scrollLeft=0,setTimeout(()=>{n.scrollBy({left:i-o+240,behavior:"smooth"})},50)):n.scrollBy({left:"left"===t?-960:a,behavior:"smooth"})}(e.currentTarget.dataset.section,e.currentTarget.classList.contains("left")?"left":"right")},500))}),document.addEventListener("keydown",e=>{"Escape"===e.key&&R()}),document.getElementById("detailModal")?.addEventListener("click",e=>{"detailModal"===e.target.id&&R()})}window.changeSeason=async function(e){$=parseInt(e),I=1,sessionStorage.setItem("velura_selected_season",e),sessionStorage.setItem("velura_selected_episode",1);const t=document.getElementById("seasonSelectFullwidth");t&&(t.value=e);const n=document.getElementById("episodesListContainer");n&&(n.innerHTML='\n            <div class="loading-episodes">\n                <div class="spinner-large"></div>\n                <p>Loading episodes...</p>\n            </div>\n        ');const a=await _(w.id,$),i=document.getElementById("watchSeriesBtn");i&&a.episodes.length>0&&(i.innerHTML='<i class="bi bi-play-fill"></i> Watch Episode 1',i.dataset.season=$,i.dataset.episode=1),E(a)},window.changeEpisode=function(e){I=parseInt(e),function(e){const t=document.getElementById("episodeDetails"),n=document.getElementById("watchSeriesBtn");if(!t||!n)return;const a=document.getElementById("episodeSelect"),i=a?.options[a.selectedIndex],o=i?.text.split(": ")[1]||`Episode ${e}`,s=new Date,r=w?.episodes?.[e-1]?.air_date,l=!r||new Date(r)<=s;t.innerHTML=`\n        <h4>${o}</h4>\n        <p class="episode-overview">${w.name} - Season ${$}, Episode ${e}</p>\n        <div class="episode-meta">\n            <span class="episode-runtime">\n                <i class="bi bi-clock"></i> ${Math.floor(w.runtime/60)}h ${w.runtime%60}m\n            </span>\n            ${r?`\n            <span class="episode-date">\n                <i class="bi bi-calendar"></i> ${new Date(r).toLocaleDateString()}\n                ${l?"":'<span class="upcoming-badge">Upcoming</span>'}\n            </span>\n            `:""}\n        </div>\n    `,l?(n.innerHTML=`<i class="bi bi-play-fill"></i> Watch Episode ${e}`,n.disabled=!1,n.classList.remove("disabled-btn")):(n.innerHTML=`<i class="bi bi-clock"></i> Releases ${new Date(r).toLocaleDateString()}`,n.disabled=!0,n.classList.add("disabled-btn"))}(e);const t=document.getElementById("watchSeriesBtn");t&&(t.innerHTML=`<i class="bi bi-play-fill"></i> Watch Episode ${e}`,t.onclick=()=>watchSelectedSeriesEpisode())},window.selectEpisode=function(e){I=parseInt(e);const t=document.getElementById("watchSeriesBtn");t&&(t.innerHTML=`<i class="bi bi-play-fill"></i> Watch Episode ${e}`,t.dataset.episode=e,t.onclick=()=>watchSelectedSeriesEpisode(),t.dataset.season=$,t.dataset.episode=I,sessionStorage.setItem("velura_selected_episode",e)),document.querySelectorAll(".episode-card").forEach(e=>{const t=parseInt(e.dataset.episode);e.classList.toggle("selected",t===I)})},window.watchSelectedSeriesEpisode=function(){if(!w)return;const e=`${w.name} - S${$}E${I}`;if(window.VeluraPlayer)window.VeluraPlayer.openPlayer(w.id.toString(),"tv",$,I,e,"tmdb");else{const t=btoa(JSON.stringify({id:w.id,type:"tv",season:$,episode:I,title:e,timestamp:Date.now()}));window.location.href=`/php/player/play.php?play=${encodeURIComponent(t)}`}},window.onYouTubeIframeAPIReady=function(){},window.replayTrailerSimple=function(){if(window.youtubePlayer)try{window.youtubePlayer.seekTo(0,!0),window.youtubePlayer.playVideo(),window.isMuted?window.youtubePlayer.mute():window.youtubePlayer.unMute()}catch(e){C()}else C()},document.addEventListener("DOMContentLoaded",async()=>{c.getCacheStats(),await async function(){try{const[e,t,n,a]=await Promise.all([d(),p(),m(),u()]);f("movies",e),f("series",t),f("tv",n),f("recommended",a)}catch(e){}}(),setTimeout(()=>{document.querySelectorAll(".trending-carousel").forEach(e=>{e.dataset.section;const t=e.querySelectorAll(".card");if(0===t.length)return;const n=Math.min(5,t.length);for(let a=0;a<n;a++){const n=t[a].cloneNode(!0);e.appendChild(n)}e.addEventListener("scroll",()=>{const t=e.scrollWidth,n=e.clientWidth;e.scrollLeft>=t-n-10&&(e.style.scrollBehavior="auto",e.scrollLeft=0,setTimeout(()=>{e.style.scrollBehavior="smooth"},50))})})},100),H(),window.closeModal=R,window.toggleMute=B,window.toggleCastView=P,window.onYouTubeIframeAPIReady=onYouTubeIframeAPIReady,window.replayTrailer=C,window.replayTrailerSimple=replayTrailerSimple,window.replayTrailerFromEnd=L,window.watchContent=function(e,t){const n=document.getElementById("detailModal"),a=n?.querySelector(".watch-btn");if(a){const e=a.dataset.tmdbId;if("tv"===(a.dataset.type||"movie"))"function"==typeof window.watchSelectedSeriesEpisode?window.watchSelectedSeriesEpisode():window.VeluraPlayer?.openPlayer(e,"tv",1,1,t,"tmdb");else if(window.VeluraPlayer)window.VeluraPlayer.openPlayer(e,"movie",1,1,t,"tmdb");else{const n=btoa(JSON.stringify({id:e,type:"movie",title:t}));window.location.href=`/php/player/play.php?play=${encodeURIComponent(n)}`}}},window.addToWatchlist=function(e,t){alert("Added to your watchlist!")},window.shareContent=function(e,t){const n=`${window.location.origin}/watch/${t}`;navigator.share?navigator.share({title:e,text:`Check out ${e} on Velura`,url:n}):(navigator.clipboard.writeText(`${e} - ${n}`),alert("Link copied to clipboard!"))}}),window.getMovieDetailsGlobal=v,window.showDetailsModalGlobal=N,window.showLoadingModalGlobal=q,window.initYouTubePlayerGlobal=k,window.loadYouTubeAPIGlobal=M,window.toggleMuteGlobal=B,window.replayTrailerGlobal=C,window.replayTrailerSimpleGlobal=replayTrailerSimple,window.replayTrailerFromEndGlobal=L,window.changeSeason=changeSeason,window.changeEpisode=changeEpisode,window.watchSelectedSeriesEpisode=watchSelectedSeriesEpisode,window.initYouTubePlayer720p=k,window.loadYouTubeAPI720p=M,window.showPosterOnVideoEnd=x,window.selectEpisode=selectEpisode,window.changeEpisode=function(e){"function"==typeof window.selectEpisode&&window.selectEpisode(e)},window.debugCache={showStats:()=>{const e=c.getCacheStats();alert(`Cache Stats:\nEntries: ${e.totalEntries}\nSize: ${e.totalSizeKB} KB (${e.totalSizeMB} MB)\nKeys: ${Object.keys(c.cache).join(", ")}`)},clearAll:()=>{confirm("Clear ALL cache? This will force fresh API calls.")&&(Object.keys(c.cache).forEach(e=>delete c.cache[e]),c.saveCache(),alert("Cache cleared! Reload the page."))},clearSection:e=>{const t=`${e}_movies`;c.cache[t]&&(delete c.cache[t],c.saveCache(),alert(`Cleared cache for ${e}`))}},window.checkEpisodeState=function(){document.querySelectorAll(".episode-card").forEach((e,t)=>{e.dataset.episode,e.classList.contains("selected")})};let O=null,W=!0,U=null;function F(){if(O)try{W?(O.muted=!1,O.volume=.7,document.getElementById("muteIcon").textContent="ðŸ”Š",W=!1):(O.muted=!0,document.getElementById("muteIcon").textContent="ðŸ”‡",W=!0)}catch(e){}}function j(){document.getElementById("videoBackground").innerHTML='\n    <div class="static-backdrop"></div>\n    <div class="video-overlay"></div>\n  '}function G(){document.querySelectorAll(".search-mode-active br, .search-mode-active .spacer").forEach(e=>e.style.display="none");const e=document.querySelector("velura-header");if(e){e.style.marginBottom="0",e.style.paddingBottom="0";const t=e.shadowRoot?.querySelector(".header");t&&(t.style.margin="0",t.style.padding="15px 20px")}document.querySelectorAll("section").forEach(e=>{e.style.margin="0",e.style.padding="0",e.style.minHeight="0"});const t=document.getElementById("fullPageSearch");t&&(t.style.marginTop="-10px",t.style.paddingTop="10px")}function V(){document.body.classList.remove("search-mode-active"),[".main","section",".trending-sections",".hero-container"].forEach(e=>{document.querySelectorAll(e).forEach(e=>{e.style.cssText="",e.classList.remove("search-mode")})}),document.getElementById("fullPageSearch").style.display="none";const e=document.querySelector("#site-search");e&&(e.value=""),document.getElementById("fullSearchResultsGrid").innerHTML="",document.getElementById("quickActions").innerHTML="",document.getElementById("searchResultsCount").textContent="",window.scrollTo({top:0,behavior:"smooth"})}async function Y(e){if(e&&""!==e.trim()){!function(e){document.body.classList.add("search-mode-active"),document.getElementById("fullPageSearch").style.display="block",document.getElementById("fullSearchQueryText").textContent=e,setTimeout(G,0);const t=document.querySelector("#site-search");t&&t.blur()}(e),document.getElementById("fullSearchResultsGrid").innerHTML=`\n        <div class="search-loading-full">\n            <div class="spinner"></div>\n            <p>Searching for "${e}"...</p>\n        </div>\n    `;try{const t=await fetch(`${n}/search/${encodeURIComponent(e)}?page=1`),a=await t.json();if(!a.results||0===a.results.length)return void function(e){const t=document.getElementById("fullSearchResultsGrid");t.innerHTML=`\n        <div class="no-results-full">\n            <i class="bi bi-search-x"></i>\n            <h3>No results found for "${e}"</h3>\n            <p>Try different keywords or check the spelling</p>\n        </div>\n    `}(e);const i=a.results.length;document.getElementById("searchResultsCount").textContent=` (${i} results)`,function(e){const t=document.getElementById("fullSearchResultsGrid"),n=e.slice(0,30).map((e,t)=>{const n=e.title||e.name||"Untitled",a=e.release_date?new Date(e.release_date).getFullYear():e.first_air_date?new Date(e.first_air_date).getFullYear():"N/A",i=e.vote_average?e.vote_average.toFixed(1):"N/A",o="movie"===e.media_type?"Movie":"TV Show",s=e.poster_path?`https://image.tmdb.org/t/p/w500${e.poster_path}`:"/src/assets/images/default-poster.jpg",r=Math.min(.05*t,1.5);return`\n            <div class="search-result-card-full" \n                 data-id="${e.id}" \n                 data-type="${e.media_type}"\n                 data-title="${n.replace(/"/g,"&quot;")}"\n                 onclick="openSearchResult(${e.id}, '${e.media_type}', '${n.replace(/'/g,"\\'")}')"\n                 style="animation-delay: ${r}s">\n                <div class="search-result-poster-full">\n                    <img src="${s}" alt="${n}" loading="lazy">\n                    <div class="poster-overlay"></div>\n                    <div class="play-icon-overlay">\n                        <i class="bi bi-play-fill"></i>\n                    </div>\n                </div>\n                <div class="search-result-info-full">\n                    <h3 class="search-result-title-full">${n}</h3>\n                    <div class="search-result-meta-full">\n                        <span class="search-result-rating-full">\n                            <i class="bi bi-star-fill"></i>\n                            ${i}\n                        </span>\n                        <span class="search-result-year-full">${a}</span>\n                    </div>\n                    <span class="search-result-type-badge">${o}</span>\n                </div>\n            </div>\n        `}).join("");t.innerHTML=n}(a.results),function(e){const t=document.getElementById("quickActions"),n=new Set;e.forEach(e=>{e.genre_ids&&e.genre_ids.forEach(t=>{const a=function(e,t){const n={28:"Action",12:"Adventure",16:"Animation",35:"Comedy",80:"Crime",99:"Documentary",18:"Drama",10751:"Family",14:"Fantasy",36:"History",27:"Horror",10402:"Music",9648:"Mystery",10749:"Romance",878:"Sci-Fi",10770:"TV Movie",53:"Thriller",10752:"War",37:"Western"},a={10759:"Action & Adventure",16:"Animation",35:"Comedy",80:"Crime",99:"Documentary",18:"Drama",10751:"Family",10762:"Kids",9648:"Mystery",10763:"News",10764:"Reality",10765:"Sci-Fi & Fantasy",10766:"Soap",10767:"Talk",10768:"War & Politics",37:"Western"};return"movie"===t?n[e]:a[e]}(t,e.media_type);a&&n.add(a)})});const a=Array.from(n).slice(0,8).map(e=>`\n        <button class="quick-action-btn" onclick="filterByGenre('${e}')">\n            ${e}\n        </button>\n    `).join(""),i=e.map(e=>e.release_date||e.first_air_date).filter(e=>e).map(e=>new Date(e).getFullYear()).filter((e,t,n)=>n.indexOf(e)===t).sort((e,t)=>t-e).slice(0,5).map(e=>`\n        <button class="quick-action-btn" onclick="filterByYear(${e})">\n            ${e}\n        </button>\n    `).join("");t.innerHTML=`\n        ${a}\n        ${i}\n        <button class="quick-action-btn" onclick="filterByType('movie')">\n            <i class="bi bi-film"></i> Movies\n        </button>\n        <button class="quick-action-btn" onclick="filterByType('tv')">\n            <i class="bi bi-tv"></i> TV Shows\n        </button>\n        <button class="quick-action-btn" onclick="filterByRating(7)">\n            <i class="bi bi-star"></i> 7+ Rating\n        </button>\n    `}(a.results)}catch(t){!function(){const e=document.getElementById("fullSearchResultsGrid");e.innerHTML='\n        <div class="no-results-full">\n            <i class="bi bi-wifi-off"></i>\n            <h3>Search failed</h3>\n            <p>Please check your connection and try again</p>\n        </div>\n    '}()}}else V()}function z(e){document.querySelectorAll(".search-result-card-full").forEach(e=>{e.style.display="block"})}function J(e){}function K(e){document.querySelectorAll(".search-result-card-full").forEach(t=>{const n=t.dataset.type;t.style.display=n===e?"block":"none"})}function Q(e){document.querySelectorAll(".search-result-card-full").forEach(t=>{const n=t.querySelector(".search-result-rating-full")?.textContent||"0",a=parseFloat(n.replace("â­","").trim())||0;t.style.display=a>=e?"block":"none"})}function X(e="Loading Details",t="Fetching content information..."){document.getElementById("loadingContentTitle").textContent=e||"Please wait...";const n=document.getElementById("loadingOverlay");n.style.display="flex",n.offsetHeight,setTimeout(()=>{n.classList.add("active"),document.body.classList.add("loading-active")},10),U=setTimeout(()=>{document.getElementById("loadingContentTitle").textContent="Still loading... Server might be busy"},5e3)}function Z(){const e=document.getElementById("loadingOverlay");U&&(clearTimeout(U),U=null),e.classList.remove("active"),document.body.classList.remove("loading-active"),setTimeout(()=>{e.style.display="none"},300)}function ee(e){X("Loading Details",`Preparing ${e||"content"} information...`)}async function te(e,t,a){ee(a.title||a.name);try{const i=[],o=window.getMovieDetailsGlobal(e,t,a);if(i.push(o),"tv"===e&&a.number_of_seasons){const e=fetch(`${n}/tv/${t}/season/${a.number_of_seasons}`).then(e=>e.json()).catch(e=>null);i.push(e)}const[s,r]=await Promise.all(i);return"tv"===e&&r&&(s.seasonData=r),s}catch(i){throw i}finally{Z()}}function ne(e,t,n){ee(n),window.getMovieDetailsGlobal?te(t,e,{id:e,title:n,name:n,media_type:t}).then(e=>{window.showDetailsModalGlobal?window.showDetailsModalGlobal(e):(Z(),alert(`Could not load details for ${n}`))}).catch(a=>{Z(),X("Preparing Player","Starting playback..."),setTimeout(()=>{const a=btoa(JSON.stringify({id:e,type:t,title:n}));window.location.href=`/php/player/play.php?play=${encodeURIComponent(a)}`},1e3)}):(X("Preparing Player","Starting playback..."),setTimeout(()=>{const a=btoa(JSON.stringify({id:e,type:t,title:n}));window.location.href=`/php/player/play.php?play=${encodeURIComponent(a)}`},1e3))}function ae(){const e=document.querySelector(".hero-container"),t=e?.dataset?.tmdbId,n=document.getElementById("heroTitle").textContent;if(t){const e=btoa(JSON.stringify({id:t,type:"movie",title:n})),a=`/php/player/play.php?play=${encodeURIComponent(e)}`;fetch("/php/player/play.php").then(e=>{e.ok||404===e.status?window.location.href=a:ie(t,n)}).catch(e=>{ie(t,n)})}else alert(`No content ID found for: ${n}`)}function ie(e,t){const n=btoa(JSON.stringify({id:e,type:"movie",title:t})),a=`http://localhost:8000/backend/player/play.php?play=${encodeURIComponent(n)}`;window.location.href=a}async function oe(){try{const e=document.querySelector(".hero-container"),t=e?.dataset?.tmdbId,n=e?.dataset?.title||document.getElementById("heroTitle").textContent;if(!t)return void alert("No content information available");ee(n);const a={id:parseInt(t),title:n,name:n,media_type:"movie"};if(window.getMovieDetailsGlobal){const e=await te("movie",t,a);window.showDetailsModalGlobal?window.showDetailsModalGlobal(e):(Z(),se())}else Z(),se()}catch(e){Z(),se()}}function se(){const e=document.querySelector(".hero-container"),t=document.getElementById("heroTitle").textContent,n=document.getElementById("heroDescription").textContent,a=document.getElementById("heroRating").textContent.replace("â­ ",""),i=document.getElementById("heroYear").textContent,o=document.getElementById("detailModal");o.innerHTML=`\n        <div class="modal-content">\n            <button class="close-btn" onclick="closeModal()">&times;</button>\n            \n            <div class="modal-layout">\n                <div class="modal-left">\n                    <div class="trailer-container">\n                        <div class="no-trailer-placeholder">\n                            <div class="poster-preview">\n                                <img src="https://image.tmdb.org/t/p/w500${e?.dataset?.posterPath||"/default-poster.jpg"}" \n                                     alt="${t}">\n                                <div class="play-overlay">\n                                    <i class="bi bi-play-fill"></i>\n                                </div>\n                            </div>\n                            <p class="no-trailer-text">Trailer not available</p>\n                        </div>\n                    </div>\n                    \n                    <div class="movie-info-card">\n                        <div class="info-header">\n                            <h3 class="movie-title">${t}</h3>\n                            <div class="quick-stats">\n                                <span class="rating-stat">\n                                    <i class="bi bi-star-fill"></i>\n                                    <strong>${a}</strong>/10\n                                </span>\n                                <span class="quality-stat">\n                                    <i class="bi bi-hdd-stack"></i>\n                                    HD\n                                </span>\n                                <span class="year-stat">\n                                    <i class="bi bi-calendar3"></i>\n                                    ${i}\n                                </span>\n                            </div>\n                        </div>\n                        \n                        <div class="category-chips">\n                            <span class="category-chip">Movie</span>\n                            <span class="category-chip">Action</span>\n                            <span class="category-chip">Adventure</span>\n                        </div>\n                        \n                        <div class="description-box">\n                            <h4>Description</h4>\n                            <p>${n}</p>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class="modal-right">\n                    <div class="action-buttons-grid">\n                        <button class="primary-action-btn watch-btn" onclick="watchNow()">\n                            <i class="bi bi-play-fill"></i>\n                            <span>Watch Now</span>\n                        </button>\n                        \n                        <button class="secondary-action-btn" onclick="addToWatchlist('${e?.dataset?.tmdbId||"0"}', 'movie')">\n                            <i class="bi bi-plus-lg"></i>\n                            <span>Add to List</span>\n                        </button>\n                        \n                        <button class="secondary-action-btn" onclick="shareContent('${t}', '${e?.dataset?.tmdbId||"0"}')">\n                            <i class="bi bi-share"></i>\n                            <span>Share</span>\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    `,o.classList.add("active"),document.body.classList.add("modal-open")}document.addEventListener("DOMContentLoaded",function(){if(!function(){const e=localStorage.getItem("velura_token"),t=localStorage.getItem("velura_user");return!(!e||!t)}())return;!async function(){try{const e=await fetch(`${n}/trending/movies`).then(e=>e.json());if(e&&Array.isArray(e)&&e.length>0){const t=e[0];document.getElementById("heroTitle").textContent=t.title||"Movie Title",document.getElementById("heroDescription").textContent=t.overview?t.overview.substring(0,150)+"...":"No description available",document.getElementById("heroRating").textContent=`â­ ${t.vote_average?.toFixed(1)||"N/A"}`,document.getElementById("heroYear").textContent=t.release_date?new Date(t.release_date).getFullYear():"2024",document.getElementById("heroGenre").textContent="Movie";const n=document.querySelector(".hero-container");n&&(n.dataset.tmdbId=t.id,n.dataset.title=t.title,n.dataset.posterPath=t.poster_path,n.dataset.backdropPath=t.backdrop_path,n.dataset.rating=t.vote_average,n.dataset.releaseDate=t.release_date,n.dataset.overview=t.overview);const i=`movie_${t.id}`,o=await async function(e){try{const[t,n]=e.split("_");if(!t||!n)return!1;const i=`${a}/${t}/${n}`,o=await fetch(i),s=o.headers.get("content-type");return s&&s.includes("video/mp4")?(await async function(e){document.getElementById("videoBackground").innerHTML=`\n    <video \n      id="trailerVideo"\n      class="trailer-video"\n      autoplay\n      muted\n      loop\n      playsinline\n      preload="auto"\n    >\n      <source src="${e}" type="video/mp4">\n      Your browser does not support the video tag.\n    </video>\n    <div class="video-brightness-overlay"></div>\n    <div class="video-overlay"></div>\n  `,O=document.getElementById("trailerVideo"),W=!0,document.getElementById("muteIcon").textContent="ðŸ”‡",O.addEventListener("error",function(){j()})}(i),!0):(o.ok&&(await o.json()).success,!1)}catch(t){return!1}}(i);if(!o&&t.backdrop_path){const e=`https://image.tmdb.org/t/p/original${t.backdrop_path}`;document.getElementById("videoBackground").innerHTML=`\n          <div class="backdrop-image" style="background-image: url('${e}')"></div>\n          <div class="video-overlay"></div>\n        `}else o||j();return}j(),document.getElementById("heroTitle").textContent="Stream Unlimited Content",document.getElementById("heroDescription").textContent="Experience the best movies and TV shows in high quality"}catch(e){j(),document.getElementById("heroTitle").textContent="Welcome to Velura",document.getElementById("heroDescription").textContent="Loading content..."}}(),document.getElementById("audioControl")?.addEventListener("click",F);const e=document.querySelector(".btn-watch");e&&e.addEventListener("click",ae),document.querySelector(".btn-info")?.addEventListener("click",oe);const t=document.getElementById("clearSearchFullBtn");t&&t.addEventListener("click",V),document.addEventListener("keydown",e=>{"Escape"===e.key&&(document.body.classList.contains("search-mode-active")&&V(),document.body.classList.contains("loading-active")&&confirm("Cancel loading?")&&Z())}),function(){const e=document.querySelector("velura-header");if(e&&e.shadowRoot){const t=e.shadowRoot.querySelector(".logo"),n=e.shadowRoot.querySelectorAll("a"),a=e=>{if(document.body.classList.contains("loading-active"))return e.preventDefault(),e.stopPropagation(),!1};t&&t.addEventListener("click",a),n.forEach(e=>e.addEventListener("click",a))}}(),window.performLiveSearch=function(e,t){let n;return function(...a){const i=()=>{clearTimeout(n),e(...a)};clearTimeout(n),n=setTimeout(i,t)}}(Y,300),window.clearSearch=V,window.openSearchResult=ne,window.filterByGenre=z,window.filterByYear=J,window.filterByType=K,window.filterByRating=Q,window.exitSearchMode=V,window.showContentLoading=ee,window.hideLoadingOverlay=Z}),window.closeModal=function(){if(document.getElementById("detailModal").classList.remove("active"),document.body.classList.remove("modal-open"),window.youtubePlayer){try{window.youtubePlayer.stopVideo(),window.youtubePlayer.destroy()}catch(e){}window.youtubePlayer=null}},window.moreInfo=oe}},function(){return o||(0,i[e(i)[0]])((o={exports:{}}).exports,o),o.exports});export default s();
